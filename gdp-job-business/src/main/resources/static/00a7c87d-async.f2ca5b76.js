(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["00a7c87d"],{f6aee6a8:function(e,t,l){l.d(t,"__esModule",{value:!0}),l.e(t,{default:function(){return B;}});var r=l("777fffbe"),a=l("852bbaa9"),n=l("19e41895"),s=l("7b92fca5"),i=l("36e3022b"),o=r._(i),d=l("d1f794b5"),u=r._(d),c=l("3761f98e"),f=r._(c),h=l("68e5e351"),x=r._(h),g=l("434ca105"),p=r._(g),v=l("b2b06e38"),y=r._(v),m=l("44acd96a"),j=r._(m),b=l("ad24b541"),Y=l("eb28dd03"),E=a._(Y),_=l("ac9787d9"),A=r._(_);async function D(e){return(0,A.default)("/v1/dashboard/overview",{method:"GET",params:e});}async function C(e){return(0,A.default)("/v1/dashboard/chart/execution-trend",{method:"GET",params:e});}var M=l("f35497cb"),w=r._(M),k=l("8670bcc2"),S=a._(k);let T=({data:e,type:t,height:l=400,width:r="100%"})=>{let a=(0,E.useRef)(null),s=(0,E.useRef)(null),[i,o]=(0,E.useState)(!1);return(0,E.useEffect)(()=>{if(a.current&&!s.current)try{s.current=S.init(a.current),o(!0),console.log("\u2705 \u56FE\u8868\u521D\u59CB\u5316\u6210\u529F");}catch(e){console.error("\u274C \u56FE\u8868\u521D\u59CB\u5316\u5931\u8D25:",e);}return()=>{s.current&&(s.current.dispose(),s.current=null);};},[]),(0,E.useEffect)(()=>{if(i&&s.current&&e)try{let l;console.log("\u{1F525} \u5F00\u59CB\u66F4\u65B0\u56FE\u8868\u6570\u636E:",e),"line"===t?l={title:{text:"\u6267\u884C\u8D8B\u52BF\u56FE",left:"center"},tooltip:{trigger:"axis"},legend:{data:["\u6210\u529F","\u5931\u8D25","\u603B\u8BA1"],top:30},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e.dates||[]},yAxis:{type:"value"},series:[{name:"\u6210\u529F",type:"line",data:e.successCounts||[],color:"#00A65A"},{name:"\u5931\u8D25",type:"line",data:e.failedCounts||[],color:"#c23632"},{name:"\u603B\u8BA1",type:"line",data:e.totalCounts||[],color:"#F39C12"}]}:"pie"===t&&(l={title:{text:"\u6267\u884C\u72B6\u6001\u5206\u5E03",left:"center"},tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",top:"middle"},series:[{name:"\u6267\u884C\u72B6\u6001",type:"pie",radius:"50%",data:[{value:e.successExecutions||0,name:"\u6210\u529F"},{value:e.failedExecutions||0,name:"\u5931\u8D25"},{value:e.runningJobs||0,name:"\u8FD0\u884C\u4E2D"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],color:["#00A65A","#c23632","#F39C12"]}),l&&(s.current.clear(),s.current.setOption(l,!0),s.current.resize(),console.log("\u2705 \u56FE\u8868\u66F4\u65B0\u6210\u529F"),setTimeout(()=>{var e;let t=null===(e=s.current)||void 0===e?void 0:e.getOption();if(console.log("\u{1F525} \u56FE\u8868\u914D\u7F6E\u9A8C\u8BC1:",t),t&&t.series&&Array.isArray(t.series)){let e=t.series.some(e=>e.data&&Array.isArray(e.data)&&e.data.length>0);console.log("\u{1F525} \u56FE\u8868\u6709\u6570\u636E:",e);}},100));}catch(e){console.error("\u274C \u56FE\u8868\u66F4\u65B0\u5931\u8D25:",e);}},[e,t,i]),(0,E.useEffect)(()=>{let e=()=>{s.current&&s.current.resize();};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e);},[]),(0,n.jsx)("div",{ref:a,style:{width:r,height:l,border:"1px solid #f0f0f0",borderRadius:"4px",backgroundColor:"#fff",visibility:"visible",display:"block",opacity:1,position:"relative",zIndex:1}});},{RangePicker:z}=p.default,B=()=>{let[e,t]=(0,E.useState)([(0,w.default)().subtract(7,"day"),(0,w.default)()]),{data:l,loading:r,error:a,run:i}=(0,b.useRequest)(D,{pollingInterval:3e4,onError:e=>{console.error("\u83B7\u53D6\u4EEA\u8868\u677F\u6570\u636E\u5931\u8D25:",e),j.default.error("\u83B7\u53D6\u4EEA\u8868\u677F\u6570\u636E\u5931\u8D25: "+(e instanceof Error?e.message:String(e)));}}),{data:d,loading:c,error:h,run:g}=(0,b.useRequest)(()=>C({startDate:e[0].format("YYYY-MM-DD"),endDate:e[1].format("YYYY-MM-DD"),groupBy:"day"}),{refreshDeps:[e],onError:e=>{console.error("\u83B7\u53D6\u56FE\u8868\u6570\u636E\u5931\u8D25:",e),j.default.error("\u83B7\u53D6\u56FE\u8868\u6570\u636E\u5931\u8D25: "+(e instanceof Error?e.message:String(e)));}}),p=(null==l?void 0:l.data)||l,v=(null==d?void 0:d.data)||d;return(0,E.useEffect)(()=>{i(),g();},[]),(0,n.jsxs)(s.PageContainer,{title:"\u8FD0\u884C\u62A5\u8868",extra:(0,n.jsx)(y.default,{children:(0,n.jsx)(z,{value:e,onChange:e=>{e&&2===e.length&&(console.log("\u{1F525} \u65E5\u671F\u8303\u56F4\u53D8\u5316:",e[0].format("YYYY-MM-DD"),"\u5230",e[1].format("YYYY-MM-DD")),t([e[0],e[1]]),g());},format:"YYYY-MM-DD",placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"]})}),children:[a||h?(0,n.jsx)(o.default,{style:{marginBottom:16},children:(0,n.jsxs)("div",{style:{color:"red"},children:[a&&(0,n.jsxs)("div",{children:["\u4EEA\u8868\u677F\u6570\u636E\u83B7\u53D6\u5931\u8D25: ",a.message]}),h&&(0,n.jsxs)("div",{children:["\u56FE\u8868\u6570\u636E\u83B7\u53D6\u5931\u8D25: ",h.message]})]})}):null,(0,n.jsxs)(f.default,{gutter:16,style:{marginBottom:24},children:[(0,n.jsx)(u.default,{span:6,children:(0,n.jsx)(o.default,{children:(0,n.jsx)(x.default,{title:"\u4EFB\u52A1\u6570\u91CF",value:(null==p?void 0:p.totalJobs)||0,loading:r,suffix:"\u4E2A"})})}),(0,n.jsx)(u.default,{span:6,children:(0,n.jsx)(o.default,{children:(0,n.jsx)(x.default,{title:"\u603B\u6267\u884C\u6B21\u6570",value:(null==p?void 0:p.totalExecutions)||0,loading:r,suffix:"\u6B21"})})}),(0,n.jsx)(u.default,{span:6,children:(0,n.jsx)(o.default,{children:(0,n.jsx)(x.default,{title:"\u6210\u529F\u6B21\u6570",value:(null==p?void 0:p.successExecutions)||0,loading:r,suffix:"\u6B21",valueStyle:{color:"#3f8600"}})})}),(0,n.jsx)(u.default,{span:6,children:(0,n.jsx)(o.default,{children:(0,n.jsx)(x.default,{title:"\u5931\u8D25\u6B21\u6570",value:(null==p?void 0:p.failedExecutions)||0,loading:r,suffix:"\u6B21",valueStyle:{color:"#cf1322"}})})})]}),r||p?null:(0,n.jsx)(o.default,{style:{marginBottom:16},children:(0,n.jsxs)("div",{style:{textAlign:"center",color:"#666"},children:[(0,n.jsx)("p",{children:"\u6682\u65E0\u6570\u636E\uFF0C\u8BF7\u68C0\u67E5\uFF1A"}),(0,n.jsxs)("ul",{style:{textAlign:"left",display:"inline-block"},children:[(0,n.jsx)("li",{children:"\u540E\u7AEF\u670D\u52A1\u662F\u5426\u6B63\u5E38\u8FD0\u884C\uFF08localhost:8081\uFF09"}),(0,n.jsx)("li",{children:"\u6570\u636E\u5E93\u4E2D\u662F\u5426\u6709\u6570\u636E"}),(0,n.jsx)("li",{children:"API\u63A5\u53E3\u662F\u5426\u6B63\u5E38\u54CD\u5E94"})]})]})}),(0,n.jsx)(o.default,{title:"\u6267\u884C\u8D8B\u52BF\u62A5\u8868",loading:c,children:(0,n.jsxs)(f.default,{gutter:16,children:[(0,n.jsx)(u.default,{span:16,children:(0,n.jsx)(T,{type:"line",data:v,height:400,width:"100%"})}),(0,n.jsx)(u.default,{span:8,children:(0,n.jsx)(T,{type:"pie",data:p,height:400,width:"100%"})})]})})]});};}}]);
//# sourceMappingURL=00a7c87d-async.f2ca5b76.js.map