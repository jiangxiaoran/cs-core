<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aia.gdp.mapper.SysOperLogMapper">
    
    <!-- 插入操作日志 -->
    <insert id="insert" parameterType="com.aia.gdp.model.SysOperLog" useGeneratedKeys="true" keyProperty="operId">
        INSERT INTO sys_oper_log (
            title, business_type, method, request_method, operator_type,
            oper_name, dept_name, oper_url, oper_ip, oper_location,
            oper_param, json_result, status, error_msg, oper_time, cost_time
        ) VALUES (
            #{title}, #{businessType}, #{method}, #{requestMethod}, #{operatorType},
            #{operName}, #{deptName}, #{operUrl}, #{operIp}, #{operLocation},
            #{operParam}, #{jsonResult}, #{status}, #{errorMsg}, #{operTime}, #{costTime}
        )
    </insert>
    
    <!-- 查询操作日志列表 -->
    <select id="selectList" resultType="com.aia.gdp.model.SysOperLog">
        SELECT * FROM sys_oper_log 
        <where>
            <if test="title != null and title != ''">
                AND title LIKE CONCAT('%', #{title}, '%')
            </if>
            <if test="businessType != null">
                AND business_type = #{businessType}
            </if>
            <if test="operName != null and operName != ''">
                AND oper_name LIKE CONCAT('%', #{operName}, '%')
            </if>
            <if test="status != null">
                AND status = #{status}
            </if>
            <if test="startTime != null">
                AND oper_time >= #{startTime}
            </if>
            <if test="endTime != null">
                AND oper_time &lt;= #{endTime}
            </if>
        </where>
        ORDER BY oper_time DESC
    </select>
    
    <!-- 根据ID查询操作日志 -->
    <select id="selectById" resultType="com.aia.gdp.model.SysOperLog">
        SELECT * FROM sys_oper_log WHERE oper_id = #{operId}
    </select>
    
    <!-- 删除操作日志 -->
    <delete id="deleteById">
        DELETE FROM sys_oper_log WHERE oper_id = #{operId}
    </delete>
    
    <!-- 清空操作日志 -->
    <delete id="deleteAll">
        DELETE FROM sys_oper_log
    </delete>
    
</mapper>