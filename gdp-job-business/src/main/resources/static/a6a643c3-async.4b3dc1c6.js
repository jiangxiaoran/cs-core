(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["a6a643c3"],{"34d96fb4":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return el;}});var l=a("777fffbe"),r=a("852bbaa9"),o=a("19e41895"),s=a("090ba710"),d=a("7b92fca5"),i=a("093db183"),n=a("5b2127f8"),u=l._(n),c=a("44acd96a"),f=l._(c),p=a("17ec3a38"),h=l._(p),m=a("b2b06e38"),x=l._(m),b=a("61dfd942"),j=l._(b),g=a("3fb15aa3"),P=l._(g),T=a("c9db05f5"),C=l._(T),y=a("546db771"),v=l._(y),w=a("2312abc7"),I=l._(w),E=a("eb28dd03"),S=r._(E),_=a("061ac3aa"),F=a("86618ca9"),A=a("3a9c9f06"),R=l._(A),N=a("cc6033e3"),V=l._(N),k=a("3adde020"),H=l._(k),D=a("9d935925"),O=a("1da34b28"),q=l._(O),M=a("0bca9097"),J=l._(M),G=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],L=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],U=S.default.forwardRef(function(e,t){var a=e.fieldProps,l=e.children,r=e.params,s=e.proFieldProps,d=e.mode,i=e.valueEnum,n=e.request,u=e.options,c=(0,H.default)(e,L),f=(0,V.default)({options:u,mode:d||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},a),p=(0,S.useContext)(q.default);return(0,o.jsx)(J.default,(0,V.default)((0,V.default)({valueEnum:(0,D.runFunction)(i),request:n,params:r,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,V.default)({getPopupContainer:p.getPopupContainer},f),ref:t,proFieldProps:s},c),{},{children:l}));}),W=S.default.forwardRef(function(e,t){var a=e.fieldProps,l=e.children,r=e.params,s=e.proFieldProps,d=e.mode,i=e.valueEnum,n=e.request,u=e.showSearch,c=e.options,f=(0,H.default)(e,G),p=(0,S.useContext)(q.default);return(0,o.jsx)(J.default,(0,V.default)((0,V.default)({valueEnum:(0,D.runFunction)(i),request:n,params:r,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,V.default)({options:c,mode:d,showSearch:u,getPopupContainer:p.getPopupContainer},a),ref:t,proFieldProps:s},f),{},{children:l}));});W.SearchSelect=U,W.displayName="ProFormComponent";var Z=["fieldProps","proFieldProps"],$=S.default.forwardRef(function(e,t){var a=e.fieldProps,l=e.proFieldProps,r=(0,H.default)(e,Z);return(0,o.jsx)(J.default,(0,V.default)({ref:t,valueType:"textarea",fieldProps:a,proFieldProps:l},r));}),z=["fieldProps","min","proFieldProps","max"],B=S.default.forwardRef(function(e,t){var a=e.fieldProps,l=e.min,r=e.proFieldProps,s=e.max,d=(0,H.default)(e,z);return(0,o.jsx)(J.default,(0,V.default)({valueType:"digit",fieldProps:(0,V.default)({min:l,max:s},a),ref:t,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:r},d));}),K=a("7d37be2d"),Q=["fieldProps","proFieldProps"],Y=["fieldProps","proFieldProps"],X="time",ee=S.default.forwardRef(function(e,t){var a=e.fieldProps,l=e.proFieldProps,r=(0,H.default)(e,Q),s=(0,S.useContext)(q.default);return(0,o.jsx)(J.default,(0,V.default)({ref:t,fieldProps:(0,V.default)({getPopupContainer:s.getPopupContainer},a),valueType:"timeRange",proFieldProps:l,filedConfig:{valueType:"timeRange",customLightMode:!0,lightFilterLabelFormatter:function(e){return(0,K.dateArrayFormatter)(e,"HH:mm:ss");}}},r));}),et=function(e){var t=e.fieldProps,a=e.proFieldProps,l=(0,H.default)(e,Y),r=(0,S.useContext)(q.default);return(0,o.jsx)(J.default,(0,V.default)({fieldProps:(0,V.default)({getPopupContainer:r.getPopupContainer},t),valueType:X,proFieldProps:a,filedConfig:{customLightMode:!0,valueType:X}},l));};et.RangePicker=ee;let ea=({visible:e,onVisibleChange:t,onSuccess:a})=>{let[l,r]=(0,S.useState)([]);(0,S.useEffect)(()=>{e&&s();},[e]);let s=async()=>{try{let e=await (0,_.getExecutorGroups)();r(e);}catch(e){console.error("\u52A0\u8F7D\u6267\u884C\u5668\u5217\u8868\u5931\u8D25:",e);}},d=async e=>{try{if(!/^[A-Z_][A-Z0-9_]*$/.test(e.jobCode))return f.default.error("\u4F5C\u4E1A\u4EE3\u7801\u53EA\u80FD\u5305\u542B\u5927\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u6216\u4E0B\u5212\u7EBF\u5F00\u5934"),!1;let t=null;e.scheduleTime&&(t="object"==typeof e.scheduleTime&&e.scheduleTime.format?e.scheduleTime.format("HH:mm:ss"):e.scheduleTime);let l={jobCode:e.jobCode,jobName:e.jobName,jobGroup:e.jobGroup||null,jobOrder:e.jobOrder||0,groupOrder:e.groupOrder||0,procName:e.procName||null,jobParams:e.jobParams||null,jobType:e.jobType||null,scheduleTimeStr:t,status:e.status||"ACTIVE",timeoutSec:e.timeoutSec||3600,retryCount:e.retryCount||0,notifyEmail:e.notifyEmail||null,isActive:!0,isDepend:!1};return await (0,_.addJob)(l),f.default.success("\u65B0\u589E\u4EFB\u52A1\u6210\u529F"),a(),!0;}catch(e){return console.error("\u65B0\u589E\u4EFB\u52A1\u5931\u8D25:",e),f.default.error("\u65B0\u589E\u4EFB\u52A1\u5931\u8D25: "+(e.message||"\u672A\u77E5\u9519\u8BEF")),!1;}};return(0,o.jsxs)(F.ModalForm,{title:"\u65B0\u589E\u4EFB\u52A1",open:e,onOpenChange:t,onFinish:d,width:800,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:18},children:[(0,o.jsx)(R.default,{name:"jobCode",label:"\u4F5C\u4E1A\u4EE3\u7801",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u4EE3\u7801\uFF0C\u5982\uFF1ADATA_SYNC_001",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u4EE3\u7801"},{pattern:/^[A-Z_][A-Z0-9_]*$/,message:"\u4F5C\u4E1A\u4EE3\u7801\u53EA\u80FD\u5305\u542B\u5927\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u6216\u4E0B\u5212\u7EBF\u5F00\u5934"}],tooltip:"\u4F5C\u4E1A\u4EE3\u7801\u5FC5\u987B\u552F\u4E00\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u5927\u5199\u5B57\u6BCD\u548C\u4E0B\u5212\u7EBF"}),(0,o.jsx)(R.default,{name:"jobName",label:"\u4F5C\u4E1A\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u540D\u79F0"},{max:200,message:"\u4F5C\u4E1A\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26"}]}),(0,o.jsx)(R.default,{name:"jobGroup",label:"\u4F5C\u4E1A\u5206\u7EC4",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u5206\u7EC4\uFF0C\u5982\uFF1A\u6570\u636E\u5904\u7406",rules:[{max:50,message:"\u4F5C\u4E1A\u5206\u7EC4\u4E0D\u80FD\u8D85\u8FC750\u4E2A\u5B57\u7B26"}],tooltip:"\u7528\u4E8E\u5BF9\u4F5C\u4E1A\u8FDB\u884C\u5206\u7C7B\u7BA1\u7406"}),(0,o.jsx)(B,{name:"jobOrder",label:"\u4F5C\u4E1A\u987A\u5E8F",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u987A\u5E8F",min:0,initialValue:0,tooltip:"\u540C\u4E00\u5206\u7EC4\u5185\u4F5C\u4E1A\u7684\u6267\u884C\u987A\u5E8F\uFF0C\u6570\u5B57\u8D8A\u5C0F\u4F18\u5148\u7EA7\u8D8A\u9AD8"}),(0,o.jsx)(B,{name:"groupOrder",label:"\u5206\u7EC4\u987A\u5E8F",placeholder:"\u8BF7\u8F93\u5165\u5206\u7EC4\u987A\u5E8F",min:0,initialValue:0,tooltip:"\u5206\u7EC4\u7684\u663E\u793A\u987A\u5E8F\uFF0C\u6570\u5B57\u8D8A\u5C0F\u6392\u5E8F\u8D8A\u9760\u524D"}),(0,o.jsx)(R.default,{name:"procName",label:"\u5B58\u50A8\u8FC7\u7A0B\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u5B58\u50A8\u8FC7\u7A0B\u540D\u79F0\uFF0C\u5982\uFF1Asp_sync_data",rules:[{max:200,message:"\u5B58\u50A8\u8FC7\u7A0B\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26"}],tooltip:"\u5F53\u4F5C\u4E1A\u7C7B\u578B\u4E3A\u5B58\u50A8\u8FC7\u7A0B\u65F6\uFF0C\u6B64\u5B57\u6BB5\u4E3A\u5FC5\u586B"}),(0,o.jsx)($,{name:"jobParams",label:"\u4F5C\u4E1A\u53C2\u6570",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u53C2\u6570\uFF0C\u5982\uFF1A{'source':'mysql','target':'oracle'} \u6216 \u4EFB\u610F\u683C\u5F0F",rows:3,tooltip:"\u4F5C\u4E1A\u6267\u884C\u65F6\u4F20\u9012\u7ED9\u5B58\u50A8\u8FC7\u7A0B\u6216\u811A\u672C\u7684\u53C2\u6570\uFF0C\u652F\u6301\u4EFB\u610F\u683C\u5F0F"}),(0,o.jsx)(W,{name:"jobType",label:"\u4F5C\u4E1A\u7C7B\u578B",placeholder:"\u8BF7\u9009\u62E9\u4F5C\u4E1A\u7C7B\u578B",options:[{label:"\u5B58\u50A8\u8FC7\u7A0B",value:"stored_procedure"},{label:"\u811A\u672C",value:"SCRIPT"},{label:"HTTP",value:"HTTP"}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F5C\u4E1A\u7C7B\u578B"}],tooltip:"\u9009\u62E9\u4F5C\u4E1A\u7684\u6267\u884C\u65B9\u5F0F"}),(0,o.jsx)(et,{name:"scheduleTime",label:"\u8C03\u5EA6\u65F6\u95F4",placeholder:"\u8BF7\u9009\u62E9\u8C03\u5EA6\u65F6\u95F4",fieldProps:{format:"HH:mm:ss"},tooltip:"\u4F5C\u4E1A\u6BCF\u5929\u7684\u6267\u884C\u65F6\u95F4\uFF0C\u683C\u5F0F\u4E3AHH:mm:ss"}),(0,o.jsx)(W,{name:"status",label:"\u72B6\u6001",placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",options:[{label:"\u6FC0\u6D3B",value:"ACTIVE"},{label:"\u505C\u7528",value:"INACTIVE"}],initialValue:"ACTIVE",tooltip:"\u6FC0\u6D3B\u72B6\u6001\u4E0B\u7684\u4F5C\u4E1A\u4F1A\u6B63\u5E38\u8C03\u5EA6\u6267\u884C"}),(0,o.jsx)(B,{name:"timeoutSec",label:"\u8D85\u65F6\u65F6\u95F4(\u79D2)",placeholder:"\u8BF7\u8F93\u5165\u8D85\u65F6\u65F6\u95F4",min:1,max:86400,initialValue:3600,tooltip:"\u4F5C\u4E1A\u6267\u884C\u7684\u6700\u5927\u65F6\u95F4\uFF0C\u8D85\u8FC7\u6B64\u65F6\u95F4\u5C06\u88AB\u5F3A\u5236\u7EC8\u6B62"}),(0,o.jsx)(B,{name:"retryCount",label:"\u91CD\u8BD5\u6B21\u6570",placeholder:"\u8BF7\u8F93\u5165\u91CD\u8BD5\u6B21\u6570",min:0,max:10,initialValue:0,tooltip:"\u4F5C\u4E1A\u6267\u884C\u5931\u8D25\u65F6\u7684\u91CD\u8BD5\u6B21\u6570"}),(0,o.jsx)(R.default,{name:"notifyEmail",label:"\u901A\u77E5\u90AE\u7BB1",placeholder:"\u8BF7\u8F93\u5165\u901A\u77E5\u90AE\u7BB1\uFF0C\u591A\u4E2A\u90AE\u7BB1\u7528\u9017\u53F7\u5206\u9694",tooltip:"\u4F5C\u4E1A\u6267\u884C\u5B8C\u6210\u540E\u7684\u901A\u77E5\u90AE\u7BB1\uFF0C\u591A\u4E2A\u90AE\u7BB1\u7528\u9017\u53F7\u5206\u9694"})]});},el=()=>{let e=(0,S.useRef)(null),[t,a]=(0,S.useState)([]),[l,r]=(0,S.useState)(!1),n=e=>{switch(e){case"ACTIVE":return(0,o.jsx)(j.default,{color:"success",children:"\u6FC0\u6D3B"});case"INACTIVE":return(0,o.jsx)(j.default,{color:"default",children:"\u505C\u7528"});case"PAUSED":return(0,o.jsx)(j.default,{color:"warning",children:"\u6682\u505C"});case"RUNNING":return(0,o.jsx)(j.default,{color:"processing",children:"\u8FD0\u884C\u4E2D"});case"STOPPED":return(0,o.jsx)(j.default,{color:"error",children:"\u5DF2\u505C\u6B62"});default:return(0,o.jsx)(j.default,{color:"default",children:e});}},c=e=>{switch(e){case"PROCEDURE":return(0,o.jsx)(j.default,{color:"blue",children:"\u5B58\u50A8\u8FC7\u7A0B"});case"SCRIPT":return(0,o.jsx)(j.default,{color:"green",children:"\u811A\u672C"});case"HTTP":return(0,o.jsx)(j.default,{color:"orange",children:"HTTP"});default:return(0,o.jsx)(j.default,{color:"default",children:e});}},p=e=>e?(0,o.jsx)(j.default,{color:"red",children:"\u6709\u4F9D\u8D56"}):(0,o.jsx)(j.default,{color:"green",children:"\u65E0\u4F9D\u8D56"}),m=e=>e?(0,o.jsx)(j.default,{color:"success",children:"\u6FC0\u6D3B"}):(0,o.jsx)(j.default,{color:"default",children:"\u505C\u7528"}),b=t=>{let a=[];return"INACTIVE"===t.status&&a.push((0,o.jsx)("a",{onClick:async()=>{try{var a;await (0,_.startJob)(t.jobId),f.default.success("\u542F\u52A8\u6210\u529F"),null===(a=e.current)||void 0===a||a.reload();}catch(e){f.default.error("\u542F\u52A8\u5931\u8D25");}},children:"\u542F\u52A8"},"start")),a.push((0,o.jsx)("a",{onClick:()=>{h.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:`\u{786E}\u{5B9A}\u{8981}\u{5220}\u{9664}\u{4EFB}\u{52A1} "${t.jobName}" \u{5417}\u{FF1F}`,onOk:async()=>{try{var a;await (0,_.deleteJob)(t.jobId),f.default.success("\u5220\u9664\u6210\u529F"),null===(a=e.current)||void 0===a||a.reload();}catch(e){f.default.error("\u5220\u9664\u5931\u8D25");}}});},children:"\u5220\u9664"},"delete")),a;},g=[{title:"ID",dataIndex:"jobId",width:80,search:!1},{title:"\u4F5C\u4E1A\u4EE3\u7801",dataIndex:"jobCode",width:150,ellipsis:!0},{title:"\u4F5C\u4E1A\u540D\u79F0",dataIndex:"jobName",width:200,ellipsis:!0},{title:"\u4F5C\u4E1A\u5206\u7EC4",dataIndex:"jobGroup",width:120},{title:"\u5B58\u50A8\u8FC7\u7A0B",dataIndex:"procName",width:150,ellipsis:!0,search:!1},{title:"\u4EFB\u52A1\u7C7B\u578B",dataIndex:"jobType",width:120,render:(e,t)=>c(t.jobType||""),valueType:"select",valueEnum:{PROCEDURE:{text:"\u5B58\u50A8\u8FC7\u7A0B",status:"Processing"},SCRIPT:{text:"\u811A\u672C",status:"Default"},HTTP:{text:"HTTP",status:"Warning"}}},{title:"\u8C03\u5EA6\u65F6\u95F4",dataIndex:"scheduleTime",width:100,search:!1},{title:"\u72B6\u6001",dataIndex:"status",width:100,render:(e,t)=>n(t.status),valueType:"select",valueEnum:{ACTIVE:{text:"\u6FC0\u6D3B",status:"Success"},INACTIVE:{text:"\u505C\u7528",status:"Default"},PAUSED:{text:"\u6682\u505C",status:"Warning"},RUNNING:{text:"\u8FD0\u884C\u4E2D",status:"Processing"},STOPPED:{text:"\u5DF2\u505C\u6B62",status:"Error"}}},{title:"\u4F9D\u8D56\u72B6\u6001",dataIndex:"isDepend",width:100,render:(e,t)=>p(t.isDepend),search:!1},{title:"\u6FC0\u6D3B\u72B6\u6001",dataIndex:"isActive",width:100,render:(e,t)=>m(t.isActive),search:!1},{title:"\u8D85\u65F6\u65F6\u95F4(\u79D2)",dataIndex:"timeoutSec",width:120,search:!1},{title:"\u91CD\u8BD5\u6B21\u6570",dataIndex:"retryCount",width:100,search:!1},{title:"\u6700\u540E\u8FD0\u884C\u65F6\u95F4",dataIndex:"lastRunTime",width:160,search:!1,render:e=>e||"-"},{title:"\u4E0B\u6B21\u8FD0\u884C\u65F6\u95F4",dataIndex:"nextRunTime",width:160,search:!1,render:e=>e||"-"},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:(e,t)=>b(t)}],T=async l=>{if(0===t.length){f.default.warning("\u8BF7\u9009\u62E9\u8981\u64CD\u4F5C\u7684\u4EFB\u52A1");return;}let{api:r,successMsg:o,errorMsg:s}={start:{api:_.startJob,successMsg:"\u6279\u91CF\u542F\u52A8\u6210\u529F",errorMsg:"\u6279\u91CF\u542F\u52A8\u5931\u8D25"},delete:{api:_.deleteJob,successMsg:"\u6279\u91CF\u5220\u9664\u6210\u529F",errorMsg:"\u6279\u91CF\u5220\u9664\u5931\u8D25"}}[l];try{var d;await Promise.all(t.map(e=>r(e.jobId))),f.default.success(o),a([]),null===(d=e.current)||void 0===d||d.reload();}catch(e){f.default.error(s);}};return(0,o.jsxs)(d.PageContainer,{children:[(0,o.jsx)(i.ProTable,{headerTitle:"\u4EFB\u52A1\u7BA1\u7406",actionRef:e,rowKey:"jobId",search:{labelWidth:120},toolBarRender:()=>[(0,o.jsx)(u.default,{type:"primary",icon:(0,o.jsx)(C.default,{}),onClick:()=>r(!0),children:"\u65B0\u589E\u4EFB\u52A1"},"add"),(0,o.jsx)(P.default,{title:"\u542F\u52A8\u4EFB\u52A1",children:(0,o.jsx)(u.default,{icon:(0,o.jsx)(v.default,{}),onClick:()=>{if(0===t.length){f.default.warning("\u8BF7\u9009\u62E9\u8981\u542F\u52A8\u7684\u4EFB\u52A1");return;}T("start");}})},"start"),(0,o.jsx)(P.default,{title:"\u5220\u9664\u4EFB\u52A1",children:(0,o.jsx)(u.default,{icon:(0,o.jsx)(I.default,{}),danger:!0,onClick:()=>{if(0===t.length){f.default.warning("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u4EFB\u52A1");return;}h.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:`\u{786E}\u{5B9A}\u{8981}\u{5220}\u{9664}\u{9009}\u{4E2D}\u{7684} ${t.length} \u{4E2A}\u{4EFB}\u{52A1}\u{5417}\u{FF1F}`,onOk:async()=>{try{var l;await Promise.all(t.map(e=>(0,_.deleteJob)(e.jobId))),f.default.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),a([]),null===(l=e.current)||void 0===l||l.reload();}catch(e){f.default.error("\u6279\u91CF\u5220\u9664\u5931\u8D25");}}});}})},"delete")],request:async e=>{try{let t=await (0,_.getJobList)(e);if(t&&t.success){if(t.data&&t.data.list)return{data:t.data.list,total:t.data.total||0,success:!0};if(t.data&&Array.isArray(t.data))return{data:t.data,total:t.data.length,success:!0};}if(t&&t.list)return{data:t.list,total:t.total||0,success:!0};if(Array.isArray(t))return{data:t,total:t.length,success:!0};return{data:[],total:0,success:!1};}catch(e){return console.error("\u83B7\u53D6\u4EFB\u52A1\u5217\u8868\u5931\u8D25:",e),{data:[],total:0,success:!1};}},columns:g,rowSelection:{onChange:(e,t)=>a(t)},pagination:{defaultPageSize:10,showSizeChanger:!0,showQuickJumper:!0}}),t.length>0&&(0,o.jsx)(s.FooterToolbar,{extra:(0,o.jsxs)("div",{children:["\u5DF2\u9009\u62E9 ",(0,o.jsx)("a",{style:{fontWeight:600},children:t.length})," \u9879"]}),children:(0,o.jsxs)(x.default,{children:[(0,o.jsx)(u.default,{onClick:()=>T("start"),children:"\u6279\u91CF\u542F\u52A8"}),(0,o.jsx)(u.default,{onClick:()=>T("delete"),danger:!0,children:"\u6279\u91CF\u5220\u9664"})]})}),(0,o.jsx)(ea,{visible:l,onVisibleChange:r,onSuccess:()=>{var t;r(!1),null===(t=e.current)||void 0===t||t.reload();}})]});};}}]);
//# sourceMappingURL=a6a643c3-async.4b3dc1c6.js.map